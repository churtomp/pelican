<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025 Pelican Hill Golf Extravaganza</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <nav class="bg-white shadow-md p-4">
    <div class="container mx-auto flex justify-center items-center">
      <div class="relative">
        <button id="navButton" class="text-blue-600 hover:bg-blue-100 px-3 py-2 rounded-md focus:outline-none">Menu</button>
        <div id="navDropdown" class="hidden absolute mt-2 w-48 bg-white shadow-lg rounded-md py-2 z-10">
          <a href="#introduction" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" data-view="introduction">Introduction</a>
          <a href="#leaderboard" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" data-view="leaderboard">Leaderboard</a>
          <a href="#tee-times" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" data-view="tee-times">Tee Times</a>
          <a href="#games-payouts-prizes" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" data-view="games-payouts-prizes">Games/Payouts/Prizes</a>
          <a href="#day1-results" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" data-view="day1-results">Day 1 Results</a>
          <a href="#day2-results" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" data-view="day2-results">Day 2 Results</a>
          <a href="#day3-results" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" data-view="day3-results">Day 3 Results</a>
          <a href="#live-scoring" class="block px-4 py-2 text-blue-600 hover:bg-blue-100" data-view="live-scoring">Live Scoring</a>
        </div>
      </div>
    </div>
  </nav>
  <div class="container mx-auto p-4">
    <h1 id="page-title" class="text-3xl font-bold text-center mb-6">2025 Pelican Hill Golf Extravaganza</h1>
    <div id="content" class="bg-white shadow-md rounded-lg p-4 overflow-x-auto"></div>
    <p id="error" class="text-red-500 text-center mt-4 hidden">Error loading data. Please check your API key or sheet settings.</p>
  </div>

  <script>
    const SHEET_ID = '16gC5ywABEN_2Qap_IlK6pcM_JDeLTp39YHURm8Q4GB8';
    const API_KEY = 'AIzaSyBNneyNevoaa-A8JUAmJOLquLilwVGmj3c';

    const views = {
      'introduction': {
        title: '2025 Pelican Hill Extravaganza Welcome',
        fetchData: null,
        render: () => {
          return `
            <section class="mb-8">
              <h2 class="text-2xl font-bold mb-4">Welcome to the 2025 Pelican Hill Extravaganza!</h2>
              <p class="mb-4">
                Get ready for an exciting golf experience at the 2025 Pelican Hill Golf Extravaganza! This tournament features a variety of competitive and fun games, with a prize pot of $150 per player. Below, you’ll find all the details about the games, how to score, and the prize structure.
              </p>
              <p class="mb-4">
                For <strong>live scoring</strong>, visit the <a href="#live-scoring" class="text-blue-600 hover:underline" data-view="live-scoring">Live Scoring</a> page to find your group’s Google Sheet link. Enter your <strong>gross scores</strong> (actual strokes per hole) only—handicap calculations are handled automatically by the sheets and website. We recommend one person per group inputs scores during the round. Please keep a physical scorecard as a backup in case of technical issues.
              </p>
            </section>

            <section class="mb-8">
              <h2 class="text-2xl font-bold mb-4">Prize Pot Breakdown</h2>
              <p class="mb-4">Total pot: $150 per player. <em class="text-sm">Minor rounding may apply.</em></p>
              <table class="w-full text-left border-collapse">
                <thead>
                  <tr class="bg-gray-200">
                    <th class="p-2">Game</th>
                    <th class="p-2">Amount</th>
                    <th class="p-2">Payout Details</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border-t">
                    <td class="p-2">3-day Quota Game</td>
                    <td class="p-2">$47.50</td>
                    <td class="p-2">Pays 3 spots</td>
                  </tr>
                  <tr class="border-t">
                    <td class="p-2">Daily Quota Game (3 days)</td>
                    <td class="p-2">$11.67 × 3 = $35.01</td>
                    <td class="p-2">Pays 3 spots per day</td>
                  </tr>
                  <tr class="border-t">
                    <td class="p-2">Daily Gross Skins (3 days)</td>
                    <td class="p-2">$10 × 3 = $30</td>
                    <td class="p-2">Per day</td>
                  </tr>
                  <tr class="border-t">
                    <td class="p-2">Daily Net Skins (3 days)</td>
                    <td class="p-2">$10 × 3 = $30</td>
                    <td class="p-2">Per day</td>
                  </tr>
                  <tr class="border-t">
                    <td class="p-2">Closest to Pin (3 days)</td>
                    <td class="p-2">$2.50 × 3 = $7.50</td>
                    <td class="p-2">Per day, Allen’s chosen par 3</td>
                  </tr>
                </tbody>
              </table>
            </section>

            <section class="mb-8">
              <h2 class="text-2xl font-bold mb-4">Quota Game Rules</h2>
              <p class="mb-4">
                The Quota game awards points for each hole based on your performance relative to par. Your goal is to meet or exceed your <strong>Target Quota</strong>. Players with the highest points relative to their quota win.
              </p>
              <h3 class="text-xl font-semibold mb-2">Target Quota</h3>
              <p class="mb-4">
                Your Target Quota is calculated as: <code class="bg-gray-100 px-1 py-0.5 rounded">36 - Handicap Index</code>. For example, Allen’s Handicap Index of 14.3 gives a Target Quota of 21.7 (36 - 14.3).
              </p>
              <h3 class="text-xl font-semibold mb-2">Scoring</h3>
              <table class="w-full text-left border-collapse mb-4">
                <thead>
                  <tr class="bg-gray-200">
                    <th class="p-2">Result</th>
                    <th class="p-2">Points</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border-t">
                    <td class="p-2">Eagle</td>
                    <td class="p-2">8</td>
                  </tr>
                  <tr class="border-t">
                    <td class="p-2">Birdie</td>
                    <td class="p-2">4</td>
                  </tr>
                  <tr class="border-t">
                    <td class="p-2">Par</td>
                    <td class="p-2">2</td>
                  </tr>
                  <tr class="border-t">
                    <td class="p-2">Bogey</td>
                    <td class="p-2">1</td>
                  </tr>
                  <tr class="border-t">
                    <td class="p-2">Double Bogey or Worse</td>
                    <td class="p-2">0</td>
                  </tr>
                </tbody>
              </table>
              <h3 class="text-xl font-semibold mb-2">Quota Adjustments</h3>
              <p class="mb-4">
                After Day 1, your Target Quota adjusts by half the difference between your Day 1 quota points and your target. Examples:
              </p>
              <ul class="list-disc pl-6 mb-4">
                <li>Allen scores 24 points (target: 21.7). Difference: +2.3. Adjustment: +1.15. New Day 2 target: 22.85.</li>
                <li>Allen scores 17 points (target: 21.7). Difference: -4.7. Adjustment: -2.35. New Day 2 target: 19.35.</li>
              </ul>
            </section>

            <section class="mb-8">
              <h2 class="text-2xl font-bold mb-4">Skins and Closest to Pin</h2>
              <p class="mb-4">
                <strong>Skins</strong> are calculated using your Course Handicap for the selected tee boxes. Compete for both Gross and Net Skins each day.
              </p>
              <p class="mb-4">
                <strong>Closest to Pin</strong> awards $2.50 per day for 3 days. Allen will choose one par 3 each day for the Closest to Pin winner.
              </p>
            </section>

            <section class="text-center">
              <p class="mb-4">
                Ready to start? Check your group’s score sheet now!
              </p>
              <a href="#live-scoring" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700" data-view="live-scoring">Go to Live Scoring</a>
            </section>
          `;
        }
      },
      'leaderboard': {
        title: '2025 Pelican Hill Extravaganza Leaderboard',
        fetchData: async () => {
          try {
            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Sheet1!A1:G?key=${API_KEY}`);
            const data = await response.json();
            return data.values ? data.values.slice(1).map(row => [
              row[0], // Player Name
              row[1], // Combined Score
              row[4], // Round 1 Quota
              row[5], // Round 2 Quota
              row[6]  // Round 3 Quota
            ]) : [];
          } catch (error) {
            console.error('Error fetching Leaderboard data:', error);
            return [];
          }
        },
        render: (data) => {
          let html = `
            <table class="w-full text-left">
              <thead>
                <tr class="bg-gray-200">
                  <th class="p-2 cursor-pointer" onclick="sortTable('leaderboard', 0, 'string')">Player Name</th>
                  <th class="p-2 cursor-pointer" onclick="sortTable('leaderboard', 1, 'number')">Combined Score</th>
                  <th class="p-2 cursor-pointer" onclick="sortTable('leaderboard', 2, 'number')">Round 1 Quota</th>
                  <th class="p-2 cursor-pointer" onclick="sortTable('leaderboard', 3, 'number')">Round 2 Quota</th>
                  <th class="p-2 cursor-pointer" onclick="sortTable('leaderboard', 4, 'number')">Round 3 Quota</th>
                </tr>
              </thead>
              <tbody id="leaderboard-body">
                ${data.map(row => `
                  <tr class="border-t">
                    <td class="p-2">${row[0] || ''}</td>
                    <td class="p-2">${row[1] || ''}</td>
                    <td class="p-2">${row[2] || ''}</td>
                    <td class="p-2">${row[3] || ''}</td>
                    <td class="p-2">${row[4] || ''}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
            <div class="flex justify-center space-x-4 mt-4">
              <a href="#day1-results" class="text-blue-600 hover:underline" data-view="day1-results">Day 1 Results</a>
              <a href="#day2-results" class="text-blue-600 hover:underline" data-view="day2-results">Day 2 Results</a>
              <a href="#day3-results" class="text-blue-600 hover:underline" data-view="day3-results">Day 3 Results</a>
            </div>
          `;
          return html;
        }
      },
      'tee-times': {
        title: '2025 Pelican Hill Extravaganza Tee Times',
        fetchData: async () => {
          try {
            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/TeeTimes!A1:G?key=${API_KEY}`);
            const data = await response.json();
            return data.values ? data.values.slice(1) : [];
          } catch (error) {
            console.error('Error fetching Tee Times data:', error);
            return [];
          }
        },
        render: (data) => {
          return `
            <table class="w-full text-left">
              <thead>
                <tr class="bg-gray-200">
                  <th class="p-2">Date</th>
                  <th class="p-2">Course</th>
                  <th class="p-2">Tee Time</th>
                  <th class="p-2">Player 1</th>
                  <th class="p-2">Player 2</th>
                  <th class="p-2">Player 3</th>
                  <th class="p-2">Player 4</th>
                </tr>
              </thead>
              <tbody>
                ${data.map(row => `
                  <tr class="border-t">
                    <td class="p-2">${row[0] || ''}</td>
                    <td class="p-2">${row[1] || ''}</td>
                    <td class="p-2">${row[2] || ''}</td>
                    <td class="p-2">${row[3] || ''}</td>
                    <td class="p-2">${row[4] || ''}</td>
                    <td class="p-2">${row[5] || ''}</td>
                    <td class="p-2">${row[6] || ''}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          `;
        }
      },
      'games-payouts-prizes': {
        title: '2025 Pelican Hill Extravaganza Games/Payouts/Prizes',
        fetchData: async () => {
          return [
            ['Net Skins', 'TBD', '$100'],
            ['Low Net', 'TBD', '$150'],
            ['Closest to Pin', 'TBD', 'Golf Gear Set']
          ];
        },
        render: (data) => {
          return `
            <table class="w-full text-left">
              <thead>
                <tr class="bg-gray-200">
                  <th class="p-2">Game</th>
                  <th class="p-2">Winner</th>
                  <th class="p-2">Payout/Prize</th>
                </tr>
              </thead>
              <tbody>
                ${data.map(row => `
                  <tr class="border-t">
                    <td class="p-2">${row[0]}</td>
                    <td class="p-2">${row[1]}</td>
                    <td class="p-2">${row[2]}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          `;
        }
      },
      'day1-results': {
  title: '2025 Pelican Hill Extravaganza Day 1 Results',
  fetchData: async () => {
    try {
      const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day1Scores!A4:X?key=${API_KEY}`);
      const handicapResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day1Scores!A2:X2?key=${API_KEY}`);
      const parResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day1Scores!D1:U1?key=${API_KEY}`);
      const courseInfoResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day1Scores!A3:D3?key=${API_KEY}`);
      
      const data = await response.json();
      const handicapData = await handicapResponse.json();
      const parData = await parResponse.json();
      const courseInfoData = await courseInfoResponse.json();

      return {
        players: data.values ? data.values.map(row => ({
          playerName: row[0] || '',
          handicapIndex: parseFloat(row[1]) || 0,
          courseHandicap: parseInt(row[2]) || 0,
          holes: row.slice(3, 21).map(score => parseInt(score) || 0),
          f9Total: parseInt(row[21]) || row.slice(3, 12).reduce((sum, score) => sum + parseInt(score || 0), 0),
          b9Total: parseInt(row[22]) || row.slice(12, 21).reduce((sum, score) => sum + parseInt(score || 0), 0),
          total: parseInt(row[23]) || row.slice(3, 21).reduce((sum, score) => sum + parseInt(score || 0), 0)
        })) : [],
        handicaps: handicapData.values ? handicapData.values[0].slice(3, 21).map(h => parseInt(h) || 0) : [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
        parValues: parData.values ? parData.values[0].map(p => parseInt(p) || 4) : [4, 4, 3, 5, 4, 3, 4, 4, 5, 4, 4, 3, 5, 4, 3, 4, 4, 5],
        courseInfo: courseInfoData.values ? {
          courseName: courseInfoData.values[0][0] || 'Pelican Hill - Ocean North',
          teesPlayed: courseInfoData.values[0][3] || 'Blue',
          rating: parseFloat(courseInfoData.values[0][1]) || 72.5,
          slope: parseInt(courseInfoData.values[0][2]) || 135
        } : { courseName: 'Pelican Hill - Ocean North', teesPlayed: 'Blue', rating: 72.5, slope: 135 }
      };
    } catch (error) {
      console.error('Error fetching Day 1 data:', error);
      return {
        players: [],
        handicaps: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
        parValues: [4, 4, 3, 5, 4, 3, 4, 4, 5, 4, 4, 3, 5, 4, 3, 4, 4, 5],
        courseInfo: { courseName: 'Pelican Hill - Ocean North', teesPlayed: 'Blue', rating: 72.5, slope: 135 }
      };
    }
  },
  render: (data) => {
    // Compute gross skins
    const grossSkins = Array(18).fill(null);
    for (let hole = 0; hole < 18; hole++) {
      const scores = data.players.map(player => player.holes[hole]).filter(score => score > 0);
      if (scores.length > 0) {
        const minScore = Math.min(...scores);
        const scoreCounts = scores.reduce((acc, score) => ({ ...acc, [score]: (acc[score] || 0) + 1 }), {});
        if (scoreCounts[minScore] === 1) {
          const winnerIndex = data.players.findIndex(player => player.holes[hole] === minScore);
          grossSkins[hole] = winnerIndex;
        }
      }
    }

    // Compute net scores and net skins
    const netScores = data.players.map(player => {
      const strokes = data.handicaps.map(hcp => player.courseHandicap >= hcp ? 1 : 0);
      return player.holes.map((gross, i) => Math.max(0, gross - strokes[i]));
    });
    const netSkins = Array(18).fill(null);
    for (let hole = 0; hole < 18; hole++) {
      const scores = netScores.map(playerScores => playerScores[hole]).filter(score => score > 0);
      if (scores.length > 0) {
        const minScore = Math.min(...scores);
        const scoreCounts = scores.reduce((acc, score) => ({ ...acc, [score]: (acc[score] || 0) + 1 }), {});
        if (scoreCounts[minScore] === 1) {
          const winnerIndex = netScores.findIndex(playerScores => playerScores[hole] === minScore);
          netSkins[hole] = winnerIndex;
        }
      }
    }

    // Compute total par values
    const f9TotalPar = data.parValues.slice(0, 9).reduce((sum, p) => sum + p, 0);
    const b9TotalPar = data.parValues.slice(9, 18).reduce((sum, p) => sum + p, 0);
    const totalPar = data.parValues.reduce((sum, p) => sum + p, 0);

    // Compute quota points
    const quotaPoints = data.players.map(player => {
      return player.holes.map((gross, i) => {
        const diff = gross - data.parValues[i];
        if (diff <= -2) return 8; // Eagle
        if (diff === -1) return 4; // Birdie
        if (diff === 0) return 2; // Par
        if (diff === 1) return 1; // Bogey
        return 0; // Double Bogey+
      });
    });

    return `
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Course Information</h2>
        <div class="bg-white shadow-md rounded-lg p-4">
          <table class="w-full text-left">
            <tbody>
              <tr>
                <td class="p-2 font-medium">Course Name</td>
                <td class="p-2">${data.courseInfo.courseName}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Tees Played</td>
                <td class="p-2">${data.courseInfo.teesPlayed}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Rating</td>
                <td class="p-2">${data.courseInfo.rating.toFixed(1)}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Slope</td>
                <td class="p-2">${data.courseInfo.slope}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Gross Score</h2>
        <div id="gross-score" class="bg-white shadow-md rounded-lg p-4 overflow-x-auto">
          <table class="w-full text-left">
            <thead>
              <tr class="bg-gray-300">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.handicaps.slice(0, 9).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                ${data.handicaps.slice(9, 18).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                <th class="p-2"></th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.parValues.slice(0, 9).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${f9TotalPar}</th>
                ${data.parValues.slice(9, 18).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${b9TotalPar}</th>
                <th class="p-2 text-center">Par ${totalPar}</th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 0, 'string')">Player Name</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 1, 'number')">Handicap Index</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 2, 'number')">Course Handicap</th>
                <th class="p-2">Hole 1</th>
                <th class="p-2">Hole 2</th>
                <th class="p-2">Hole 3</th>
                <th class="p-2">Hole 4</th>
                <th class="p-2">Hole 5</th>
                <th class="p-2">Hole 6</th>
                <th class="p-2">Hole 7</th>
                <th class="p-2">Hole 8</th>
                <th class="p-2">Hole 9</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 12, 'number')">F9 Total</th>
                <th class="p-2">Hole 10</th>
                <th class="p-2">Hole 11</th>
                <th class="p-2">Hole 12</th>
                <th class="p-2">Hole 13</th>
                <th class="p-2">Hole 14</th>
                <th class="p-2">Hole 15</th>
                <th class="p-2">Hole 16</th>
                <th class="p-2">Hole 17</th>
                <th class="p-2">Hole 18</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 22, 'number')">B9 Total</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 23, 'number')">Total</th>
              </tr>
            </thead>
            <tbody id="day1-results-body">
              ${data.players.map((row, playerIndex) => `
                <tr class="border-t">
                  <td class="p-2">${row.playerName}</td>
                  <td class="p-2">${row.handicapIndex.toFixed(1)}</td>
                  <td class="p-2">${row.courseHandicap}</td>
                  ${row.holes.slice(0, 9).map((score, holeIndex) => `
                    <td class="p-2 ${grossSkins[holeIndex] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${row.f9Total}</td>
                  ${row.holes.slice(9, 18).map((score, holeIndex) => `
                    <td class="p-2 ${grossSkins[holeIndex + 9] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${row.b9Total}</td>
                  <td class="p-2">${row.total}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Net Score</h2>
        <div id="net-score" class="bg-white shadow-md rounded-lg p-4 overflow-x-auto">
          <table class="w-full text-left">
            <thead>
              <tr class="bg-gray-300">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.handicaps.slice(0, 9).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                ${data.handicaps.slice(9, 18).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                <th class="p-2"></th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.parValues.slice(0, 9).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${f9TotalPar}</th>
                ${data.parValues.slice(9, 18).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${b9TotalPar}</th>
                <th class="p-2 text-center">Par ${totalPar}</th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 0, 'string')">Player Name</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 1, 'number')">Handicap Index</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 2, 'number')">Course Handicap</th>
                <th class="p-2">Hole 1</th>
                <th class="p-2">Hole 2</th>
                <th class="p-2">Hole 3</th>
                <th class="p-2">Hole 4</th>
                <th class="p-2">Hole 5</th>
                <th class="p-2">Hole 6</th>
                <th class="p-2">Hole 7</th>
                <th class="p-2">Hole 8</th>
                <th class="p-2">Hole 9</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 12, 'number')">F9 Total</th>
                <th class="p-2">Hole 10</th>
                <th class="p-2">Hole 11</th>
                <th class="p-2">Hole 12</th>
                <th class="p-2">Hole 13</th>
                <th class="p-2">Hole 14</th>
                <th class="p-2">Hole 15</th>
                <th class="p-2">Hole 16</th>
                <th class="p-2">Hole 17</th>
                <th class="p-2">Hole 18</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 22, 'number')">B9 Total</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 23, 'number')">Total</th>
              </tr>
            </thead>
            <tbody id="day1-results-net-body">
              ${data.players.map((row, playerIndex) => `
                <tr class="border-t">
                  <td class="p-2">${row.playerName}</td>
                  <td class="p-2">${row.handicapIndex.toFixed(1)}</td>
                  <td class="p-2">${row.courseHandicap}</td>
                  ${netScores[playerIndex].slice(0, 9).map((score, holeIndex) => `
                    <td class="p-2 ${netSkins[holeIndex] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${netScores[playerIndex].slice(0, 9).reduce((sum, score) => sum + score, 0)}</td>
                  ${netScores[playerIndex].slice(9, 18).map((score, holeIndex) => `
                    <td class="p-2 ${netSkins[holeIndex + 9] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${netScores[playerIndex].slice(9, 18).reduce((sum, score) => sum + score, 0)}</td>
                  <td class="p-2">${netScores[playerIndex].reduce((sum, score) => sum + score, 0)}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Quota Points</h2>
        <div id="quota-points" class="bg-white shadow-md rounded-lg p-4 overflow-x-auto">
          <table class="w-full text-left">
            <thead>
              <tr class="bg-gray-300">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.handicaps.slice(0, 9).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                ${data.handicaps.slice(9, 18).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                <th class="p-2"></th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.parValues.slice(0, 9).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${f9TotalPar}</th>
                ${data.parValues.slice(9, 18).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${b9TotalPar}</th>
                <th class="p-2 text-center">Par ${totalPar}</th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 0, 'string')">Player Name</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 1, 'number')">Handicap Index</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 2, 'number')">Course Handicap</th>
                <th class="p-2">Hole 1</th>
                <th class="p-2">Hole 2</th>
                <th class="p-2">Hole 3</th>
                <th class="p-2">Hole 4</th>
                <th class="p-2">Hole 5</th>
                <th class="p-2">Hole 6</th>
                <th class="p-2">Hole 7</th>
                <th class="p-2">Hole 8</th>
                <th class="p-2">Hole 9</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 12, 'number')">F9 Total</th>
                <th class="p-2">Hole 10</th>
                <th class="p-2">Hole 11</th>
                <th class="p-2">Hole 12</th>
                <th class="p-2">Hole 13</th>
                <th class="p-2">Hole 14</th>
                <th class="p-2">Hole 15</th>
                <th class="p-2">Hole 16</th>
                <th class="p-2">Hole 17</th>
                <th class="p-2">Hole 18</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 22, 'number')">B9 Total</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day1-results', 23, 'number')">Total</th>
              </tr>
            </thead>
            <tbody id="day1-results-quota-body">
              ${data.players.map((row, playerIndex) => `
                <tr class="border-t">
                  <td class="p-2">${row.playerName}</td>
                  <td class="p-2">${row.handicapIndex.toFixed(1)}</td>
                  <td class="p-2">${row.courseHandicap}</td>
                  ${quotaPoints[playerIndex].slice(0, 9).map(points => `
                    <td class="p-2">${points}</td>
                  `).join('')}
                  <td class="p-2">${quotaPoints[playerIndex].slice(0, 9).reduce((sum, points) => sum + points, 0)}</td>
                  ${quotaPoints[playerIndex].slice(9, 18).map(points => `
                    <td class="p-2">${points}</td>
                  `).join('')}
                  <td class="p-2">${quotaPoints[playerIndex].slice(9, 18).reduce((sum, points) => sum + points, 0)}</td>
                  <td class="p-2">${quotaPoints[playerIndex].reduce((sum, points) => sum + points, 0)}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Game Winners</h2>
        <p>Placeholder for Daily Quota, Skins, Closest to Pin winners. Specify data source (e.g., 'Day1Winners!A1:C' for Game, Winner, Prize).</p>
      </section>
    `;
  }
},
     'day2-results': {
  title: '2025 Pelican Hill Extravaganza Day 2 Results',
  fetchData: async () => {
    try {
      const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day2Scores!A4:X?key=${API_KEY}`);
      const handicapResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day2Scores!A2:X2?key=${API_KEY}`);
      const parResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day2Scores!D1:U1?key=${API_KEY}`);
      const courseInfoResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day2Scores!A3:D3?key=${API_KEY}`);
      
      const data = await response.json();
      const handicapData = await handicapResponse.json();
      const parData = await parResponse.json();
      const courseInfoData = await courseInfoResponse.json();

      return {
        players: data.values ? data.values.map(row => ({
          playerName: row[0] || '',
          handicapIndex: parseFloat(row[1]) || 0,
          courseHandicap: parseInt(row[2]) || 0,
          holes: row.slice(3, 21).map(score => parseInt(score) || 0),
          f9Total: parseInt(row[21]) || row.slice(3, 12).reduce((sum, score) => sum + parseInt(score || 0), 0),
          b9Total: parseInt(row[22]) || row.slice(12, 21).reduce((sum, score) => sum + parseInt(score || 0), 0),
          total: parseInt(row[23]) || row.slice(3, 21).reduce((sum, score) => sum + parseInt(score || 0), 0)
        })) : [],
        handicaps: handicapData.values ? handicapData.values[0].slice(3, 21).map(h => parseInt(h) || 0) : [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
        parValues: parData.values ? parData.values[0].map(p => parseInt(p) || 4) : [4, 4, 3, 5, 4, 3, 4, 4, 5, 4, 4, 3, 5, 4, 3, 4, 4, 5],
        courseInfo: courseInfoData.values ? {
          courseName: courseInfoData.values[0][0] || 'Pelican Hill - Ocean South',
          teesPlayed: courseInfoData.values[0][3] || 'Blue',
          rating: parseFloat(courseInfoData.values[0][1]) || 70.0,
          slope: parseInt(courseInfoData.values[0][2]) || 130
        } : { courseName: 'Pelican Hill - Ocean South', teesPlayed: 'Blue', rating: 70.0, slope: 130 }
      };
    } catch (error) {
      console.error('Error fetching Day 2 data:', error);
      return {
        players: [],
        handicaps: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
        parValues: [4, 4, 3, 5, 4, 3, 4, 4, 5, 4, 4, 3, 5, 4, 3, 4, 4, 5],
        courseInfo: { courseName: 'Pelican Hill - Ocean South', teesPlayed: 'Blue', rating: 70.0, slope: 130 }
      };
    }
  },
  render: (data) => {
    // Compute gross skins
    const grossSkins = Array(18).fill(null);
    for (let hole = 0; hole < 18; hole++) {
      const scores = data.players.map(player => player.holes[hole]).filter(score => score > 0);
      if (scores.length > 0) {
        const minScore = Math.min(...scores);
        const scoreCounts = scores.reduce((acc, score) => ({ ...acc, [score]: (acc[score] || 0) + 1 }), {});
        if (scoreCounts[minScore] === 1) {
          const winnerIndex = data.players.findIndex(player => player.holes[hole] === minScore);
          grossSkins[hole] = winnerIndex;
        }
      }
    }

    // Compute net scores and net skins
    const netScores = data.players.map(player => {
      const strokes = data.handicaps.map(hcp => player.courseHandicap >= hcp ? 1 : 0);
      return player.holes.map((gross, i) => Math.max(0, gross - strokes[i]));
    });
    const netSkins = Array(18).fill(null);
    for (let hole = 0; hole < 18; hole++) {
      const scores = netScores.map(playerScores => playerScores[hole]).filter(score => score > 0);
      if (scores.length > 0) {
        const minScore = Math.min(...scores);
        const scoreCounts = scores.reduce((acc, score) => ({ ...acc, [score]: (acc[score] || 0) + 1 }), {});
        if (scoreCounts[minScore] === 1) {
          const winnerIndex = netScores.findIndex(playerScores => playerScores[hole] === minScore);
          netSkins[hole] = winnerIndex;
        }
      }
    }

    // Compute total par values
    const f9TotalPar = data.parValues.slice(0, 9).reduce((sum, p) => sum + p, 0);
    const b9TotalPar = data.parValues.slice(9, 18).reduce((sum, p) => sum + p, 0);
    const totalPar = data.parValues.reduce((sum, p) => sum + p, 0);

    return `
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Course Information</h2>
        <div class="bg-white shadow-md rounded-lg p-4">
          <table class="w-full text-left">
            <tbody>
              <tr>
                <td class="p-2 font-medium">Course Name</td>
                <td class="p-2">${data.courseInfo.courseName}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Tees Played</td>
                <td class="p-2">${data.courseInfo.teesPlayed}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Rating</td>
                <td class="p-2">${data.courseInfo.rating.toFixed(1)}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Slope</td>
                <td class="p-2">${data.courseInfo.slope}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Gross Score</h2>
        <div id="gross-score" class="bg-white shadow-md rounded-lg p-4 overflow-x-auto">
          <table class="w-full text-left">
            <thead>
              <tr class="bg-gray-300">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.handicaps.slice(0, 9).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                ${data.handicaps.slice(9, 18).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                <th class="p-2"></th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.parValues.slice(0, 9).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${f9TotalPar}</th>
                ${data.parValues.slice(9, 18).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${b9TotalPar}</th>
                <th class="p-2 text-center">Par ${totalPar}</th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 0, 'string')">Player Name</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 1, 'number')">Handicap Index</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 2, 'number')">Course Handicap</th>
                <th class="p-2">Hole 1</th>
                <th class="p-2">Hole 2</th>
                <th class="p-2">Hole 3</th>
                <th class="p-2">Hole 4</th>
                <th class="p-2">Hole 5</th>
                <th class="p-2">Hole 6</th>
                <th class="p-2">Hole 7</th>
                <th class="p-2">Hole 8</th>
                <th class="p-2">Hole 9</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 12, 'number')">F9 Total</th>
                <th class="p-2">Hole 10</th>
                <th class="p-2">Hole 11</th>
                <th class="p-2">Hole 12</th>
                <th class="p-2">Hole 13</th>
                <th class="p-2">Hole 14</th>
                <th class="p-2">Hole 15</th>
                <th class="p-2">Hole 16</th>
                <th class="p-2">Hole 17</th>
                <th class="p-2">Hole 18</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 22, 'number')">B9 Total</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 23, 'number')">Total</th>
              </tr>
            </thead>
            <tbody id="day2-results-body">
              ${data.players.map((row, playerIndex) => `
                <tr class="border-t">
                  <td class="p-2">${row.playerName}</td>
                  <td class="p-2">${row.handicapIndex.toFixed(1)}</td>
                  <td class="p-2">${row.courseHandicap}</td>
                  ${row.holes.slice(0, 9).map((score, holeIndex) => `
                    <td class="p-2 ${grossSkins[holeIndex] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${row.f9Total}</td>
                  ${row.holes.slice(9, 18).map((score, holeIndex) => `
                    <td class="p-2 ${grossSkins[holeIndex + 9] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${row.b9Total}</td>
                  <td class="p-2">${row.total}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Net Score</h2>
        <div id="net-score" class="bg-white shadow-md rounded-lg p-4 overflow-x-auto">
          <table class="w-full text-left">
            <thead>
              <tr class="bg-gray-300">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.handicaps.slice(0, 9).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                ${data.handicaps.slice(9, 18).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                <th class="p-2"></th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.parValues.slice(0, 9).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${f9TotalPar}</th>
                ${data.parValues.slice(9, 18).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${b9TotalPar}</th>
                <th class="p-2 text-center">Par ${totalPar}</th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 0, 'string')">Player Name</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 1, 'number')">Handicap Index</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 2, 'number')">Course Handicap</th>
                <th class="p-2">Hole 1</th>
                <th class="p-2">Hole 2</th>
                <th class="p-2">Hole 3</th>
                <th class="p-2">Hole 4</th>
                <th class="p-2">Hole 5</th>
                <th class="p-2">Hole 6</th>
                <th class="p-2">Hole 7</th>
                <th class="p-2">Hole 8</th>
                <th class="p-2">Hole 9</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 12, 'number')">F9 Total</th>
                <th class="p-2">Hole 10</th>
                <th class="p-2">Hole 11</th>
                <th class="p-2">Hole 12</th>
                <th class="p-2">Hole 13</th>
                <th class="p-2">Hole 14</th>
                <th class="p-2">Hole 15</th>
                <th class="p-2">Hole 16</th>
                <th class="p-2">Hole 17</th>
                <th class="p-2">Hole 18</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 22, 'number')">B9 Total</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day2-results', 23, 'number')">Total</th>
              </tr>
            </thead>
            <tbody id="day2-results-net-body">
              ${data.players.map((row, playerIndex) => `
                <tr class="border-t">
                  <td class="p-2">${row.playerName}</td>
                  <td class="p-2">${row.handicapIndex.toFixed(1)}</td>
                  <td class="p-2">${row.courseHandicap}</td>
                  ${netScores[playerIndex].slice(0, 9).map((score, holeIndex) => `
                    <td class="p-2 ${netSkins[holeIndex] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${netScores[playerIndex].slice(0, 9).reduce((sum, score) => sum + score, 0)}</td>
                  ${netScores[playerIndex].slice(9, 18).map((score, holeIndex) => `
                    <td class="p-2 ${netSkins[holeIndex + 9] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${netScores[playerIndex].slice(9, 18).reduce((sum, score) => sum + score, 0)}</td>
                  <td class="p-2">${netScores[playerIndex].reduce((sum, score) => sum + score, 0)}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Game Winners</h2>
        <p>Placeholder for Daily Quota, Skins, Closest to Pin winners. Specify data source (e.g., 'Day2Winners!A1:C' for Game, Winner, Prize).</p>
      </section>
    `;
  }
},
    'day3-results': {
  title: '2025 Pelican Hill Extravaganza Day 3 Results',
  fetchData: async () => {
    try {
      const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day3Scores!A4:X?key=${API_KEY}`);
      const handicapResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day3Scores!A2:X2?key=${API_KEY}`);
      const parResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day3Scores!D1:U1?key=${API_KEY}`);
      const courseInfoResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Day3Scores!A3:D3?key=${API_KEY}`);
      
      const data = await response.json();
      const handicapData = await handicapResponse.json();
      const parData = await parResponse.json();
      const courseInfoData = await courseInfoResponse.json();

      return {
        players: data.values ? data.values.map(row => ({
          playerName: row[0] || '',
          handicapIndex: parseFloat(row[1]) || 0,
          courseHandicap: parseInt(row[2]) || 0,
          holes: row.slice(3, 21).map(score => parseInt(score) || 0),
          f9Total: parseInt(row[21]) || row.slice(3, 12).reduce((sum, score) => sum + parseInt(score || 0), 0),
          b9Total: parseInt(row[22]) || row.slice(12, 21).reduce((sum, score) => sum + parseInt(score || 0), 0),
          total: parseInt(row[23]) || row.slice(3, 21).reduce((sum, score) => sum + parseInt(score || 0), 0)
        })) : [],
        handicaps: handicapData.values ? handicapData.values[0].slice(3, 21).map(h => parseInt(h) || 0) : [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
        parValues: parData.values ? parData.values[0].map(p => parseInt(p) || 4) : [4, 4, 3, 5, 4, 3, 4, 4, 5, 4, 4, 3, 5, 4, 3, 4, 4, 5],
        courseInfo: courseInfoData.values ? {
          courseName: courseInfoData.values[0][0] || 'Pelican Hill - Ocean North',
          teesPlayed: courseInfoData.values[0][3] || 'Blue',
          rating: parseFloat(courseInfoData.values[0][1]) || 72.5,
          slope: parseInt(courseInfoData.values[0][2]) || 135
        } : { courseName: 'Pelican Hill - Ocean North', teesPlayed: 'Blue', rating: 72.5, slope: 135 }
      };
    } catch (error) {
      console.error('Error fetching Day 3 data:', error);
      return {
        players: [],
        handicaps: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],
        parValues: [4, 4, 3, 5, 4, 3, 4, 4, 5, 4, 4, 3, 5, 4, 3, 4, 4, 5],
        courseInfo: { courseName: 'Pelican Hill - Ocean North', teesPlayed: 'Blue', rating: 72.5, slope: 135 }
      };
    }
  },
  render: (data) => {
    // Compute gross skins
    const grossSkins = Array(18).fill(null);
    for (let hole = 0; hole < 18; hole++) {
      const scores = data.players.map(player => player.holes[hole]).filter(score => score > 0);
      if (scores.length > 0) {
        const minScore = Math.min(...scores);
        const scoreCounts = scores.reduce((acc, score) => ({ ...acc, [score]: (acc[score] || 0) + 1 }), {});
        if (scoreCounts[minScore] === 1) {
          const winnerIndex = data.players.findIndex(player => player.holes[hole] === minScore);
          grossSkins[hole] = winnerIndex;
        }
      }
    }

    // Compute net scores and net skins
    const netScores = data.players.map(player => {
      const strokes = data.handicaps.map(hcp => player.courseHandicap >= hcp ? 1 : 0);
      return player.holes.map((gross, i) => Math.max(0, gross - strokes[i]));
    });
    const netSkins = Array(18).fill(null);
    for (let hole = 0; hole < 18; hole++) {
      const scores = netScores.map(playerScores => playerScores[hole]).filter(score => score > 0);
      if (scores.length > 0) {
        const minScore = Math.min(...scores);
        const scoreCounts = scores.reduce((acc, score) => ({ ...acc, [score]: (acc[score] || 0) + 1 }), {});
        if (scoreCounts[minScore] === 1) {
          const winnerIndex = netScores.findIndex(playerScores => playerScores[hole] === minScore);
          netSkins[hole] = winnerIndex;
        }
      }
    }

    // Compute total par values
    const f9TotalPar = data.parValues.slice(0, 9).reduce((sum, p) => sum + p, 0);
    const b9TotalPar = data.parValues.slice(9, 18).reduce((sum, p) => sum + p, 0);
    const totalPar = data.parValues.reduce((sum, p) => sum + p, 0);

    return `
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Course Information</h2>
        <div class="bg-white shadow-md rounded-lg p-4">
          <table class="w-full text-left">
            <tbody>
              <tr>
                <td class="p-2 font-medium">Course Name</td>
                <td class="p-2">${data.courseInfo.courseName}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Tees Played</td>
                <td class="p-2">${data.courseInfo.teesPlayed}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Rating</td>
                <td class="p-2">${data.courseInfo.rating.toFixed(1)}</td>
              </tr>
              <tr>
                <td class="p-2 font-medium">Slope</td>
                <td class="p-2">${data.courseInfo.slope}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Gross Score</h2>
        <div id="gross-score" class="bg-white shadow-md rounded-lg p-4 overflow-x-auto">
          <table class="w-full text-left">
            <thead>
              <tr class="bg-gray-300">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.handicaps.slice(0, 9).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                ${data.handicaps.slice(9, 18).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                <th class="p-2"></th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.parValues.slice(0, 9).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${f9TotalPar}</th>
                ${data.parValues.slice(9, 18).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${b9TotalPar}</th>
                <th class="p-2 text-center">Par ${totalPar}</th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 0, 'string')">Player Name</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 1, 'number')">Handicap Index</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 2, 'number')">Course Handicap</th>
                <th class="p-2">Hole 1</th>
                <th class="p-2">Hole 2</th>
                <th class="p-2">Hole 3</th>
                <th class="p-2">Hole 4</th>
                <th class="p-2">Hole 5</th>
                <th class="p-2">Hole 6</th>
                <th class="p-2">Hole 7</th>
                <th class="p-2">Hole 8</th>
                <th class="p-2">Hole 9</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 12, 'number')">F9 Total</th>
                <th class="p-2">Hole 10</th>
                <th class="p-2">Hole 11</th>
                <th class="p-2">Hole 12</th>
                <th class="p-2">Hole 13</th>
                <th class="p-2">Hole 14</th>
                <th class="p-2">Hole 15</th>
                <th class="p-2">Hole 16</th>
                <th class="p-2">Hole 17</th>
                <th class="p-2">Hole 18</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 22, 'number')">B9 Total</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 23, 'number')">Total</th>
              </tr>
            </thead>
            <tbody id="day3-results-body">
              ${data.players.map((row, playerIndex) => `
                <tr class="border-t">
                  <td class="p-2">${row.playerName}</td>
                  <td class="p-2">${row.handicapIndex.toFixed(1)}</td>
                  <td class="p-2">${row.courseHandicap}</td>
                  ${row.holes.slice(0, 9).map((score, holeIndex) => `
                    <td class="p-2 ${grossSkins[holeIndex] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${row.f9Total}</td>
                  ${row.holes.slice(9, 18).map((score, holeIndex) => `
                    <td class="p-2 ${grossSkins[holeIndex + 9] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${row.b9Total}</td>
                  <td class="p-2">${row.total}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Net Score</h2>
        <div id="net-score" class="bg-white shadow-md rounded-lg p-4 overflow-x-auto">
          <table class="w-full text-left">
            <thead>
              <tr class="bg-gray-300">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.handicaps.slice(0, 9).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                ${data.handicaps.slice(9, 18).map(h => `<th class="p-2 text-center">HCP ${h}</th>`).join('')}
                <th class="p-2"></th>
                <th class="p-2"></th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2"></th>
                <th class="p-2"></th>
                <th class="p-2"></th>
                ${data.parValues.slice(0, 9).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${f9TotalPar}</th>
                ${data.parValues.slice(9, 18).map(p => `<th class="p-2 text-center">Par ${p}</th>`).join('')}
                <th class="p-2 text-center">Par ${b9TotalPar}</th>
                <th class="p-2 text-center">Par ${totalPar}</th>
              </tr>
              <tr class="bg-gray-200">
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 0, 'string')">Player Name</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 1, 'number')">Handicap Index</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 2, 'number')">Course Handicap</th>
                <th class="p-2">Hole 1</th>
                <th class="p-2">Hole 2</th>
                <th class="p-2">Hole 3</th>
                <th class="p-2">Hole 4</th>
                <th class="p-2">Hole 5</th>
                <th class="p-2">Hole 6</th>
                <th class="p-2">Hole 7</th>
                <th class="p-2">Hole 8</th>
                <th class="p-2">Hole 9</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 12, 'number')">F9 Total</th>
                <th class="p-2">Hole 10</th>
                <th class="p-2">Hole 11</th>
                <th class="p-2">Hole 12</th>
                <th class="p-2">Hole 13</th>
                <th class="p-2">Hole 14</th>
                <th class="p-2">Hole 15</th>
                <th class="p-2">Hole 16</th>
                <th class="p-2">Hole 17</th>
                <th class="p-2">Hole 18</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 22, 'number')">B9 Total</th>
                <th class="p-2 cursor-pointer" onclick="sortTable('day3-results', 23, 'number')">Total</th>
              </tr>
            </thead>
            <tbody id="day3-results-net-body">
              ${data.players.map((row, playerIndex) => `
                <tr class="border-t">
                  <td class="p-2">${row.playerName}</td>
                  <td class="p-2">${row.handicapIndex.toFixed(1)}</td>
                  <td class="p-2">${row.courseHandicap}</td>
                  ${netScores[playerIndex].slice(0, 9).map((score, holeIndex) => `
                    <td class="p-2 ${netSkins[holeIndex] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${netScores[playerIndex].slice(0, 9).reduce((sum, score) => sum + score, 0)}</td>
                  ${netScores[playerIndex].slice(9, 18).map((score, holeIndex) => `
                    <td class="p-2 ${netSkins[holeIndex + 9] === playerIndex ? 'bg-green-200' : ''}">${score}</td>
                  `).join('')}
                  <td class="p-2">${netScores[playerIndex].slice(9, 18).reduce((sum, score) => sum + score, 0)}</td>
                  <td class="p-2">${netScores[playerIndex].reduce((sum, score) => sum + score, 0)}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      </section>
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-4">Game Winners</h2>
        <p>Placeholder for Daily Quota, Skins, Closest to Pin winners. Specify data source (e.g., 'Day3Winners!A1:C' for Game, Winner, Prize).</p>
      </section>
    `;
  }
},
      'live-scoring': {
        title: '2025 Pelican Hill Extravaganza Live Scoring',
        fetchData: async () => {
          try {
            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/LiveScoring!A1:H?key=${API_KEY}`);
            const data = await response.json();
            return data.values ? data.values.slice(1) : [];
          } catch (error) {
            console.error('Error fetching Live Scoring data:', error);
            return [];
          }
        },
        render: (data) => {
          return `
            <table class="w-full text-left">
              <thead>
                <tr class="bg-gray-200">
                  <th class="p-2">Date</th>
                  <th class="p-2">Course</th>
                  <th class="p-2">Tee Time</th>
                  <th class="p-2">Player 1</th>
                  <th class="p-2">Player 2</th>
                  <th class="p-2">Player 3</th>
                  <th class="p-2">Player 4</th>
                  <th class="p-2">Live Scoring Link</th>
                </tr>
              </thead>
              <tbody>
                ${data.map(row => `
                  <tr class="border-t">
                    <td class="p-2">${row[0] || ''}</td>
                    <td class="p-2">${row[1] || ''}</td>
                    <td class="p-2">${row[2] || ''}</td>
                    <td class="p-2">${row[3] || ''}</td>
                    <td class="p-2">${row[4] || ''}</td>
                    <td class="p-2">${row[5] || ''}</td>
                    <td class="p-2">${row[6] || ''}</td>
                    <td class="p-2"><a href="${row[7] || '#'}" class="text-blue-600 hover:underline" target="_blank">${row[7] ? 'Enter Scores' : 'No Link'}</a></td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          `;
        }
      }
    };

    let viewData = {};
    let sortStates = {};

    async function loadView(view) {
      const content = document.getElementById('content');
      const title = document.getElementById('page-title');
      const error = document.getElementById('error');

      error.classList.add('hidden');
      content.innerHTML = 'Loading...';

      try {
        if (!viewData[view] && views[view].fetchData) {
          viewData[view] = await views[view].fetchData();
        }
        title.textContent = views[view].title;
        content.innerHTML = views[view].render(viewData[view] || {});
        updateActiveMenuItem(view);
      } catch (err) {
        console.error('Error loading view:', err);
        error.classList.remove('hidden');
      }
    }

    function updateActiveMenuItem(view) {
      const menuItems = document.querySelectorAll('#navDropdown a');
      menuItems.forEach(item => {
        item.classList.toggle('font-bold', item.dataset.view === view);
      });
    }

    window.sortTable = function(view, column, type) {
      if (!sortStates[view]) {
        sortStates[view] = { column: -1, direction: 1 };
      }

      if (sortStates[view].column === column) {
        sortStates[view].direction *= -1;
      } else {
        sortStates[view].column = column;
        sortStates[view].direction = 1;
      }

      let data = viewData[view];
      if (view.includes('results')) {
        data = data.players;
      }

      data.sort((a, b) => {
        let valueA = view.includes('results') ? a[Object.keys(a)[column]] : a[column] || '';
        let valueB = view.includes('results') ? b[Object.keys(b)[column]] : b[column] || '';

        if (type === 'number') {
          valueA = parseFloat(valueA) || 0;
          valueB = parseFloat(valueB) || 0;
          return (valueA - valueB) * sortStates[view].direction;
        } else {
          valueA = valueA.toString().toLowerCase();
          valueB = valueB.toString().toLowerCase();
          return valueA.localeCompare(valueB) * sortStates[view].direction;
        }
      });

      if (view.includes('results')) {
        viewData[view].players = data;
      } else {
        viewData[view] = data;
      }

      loadView(view);
    };

    document.getElementById('navButton').addEventListener('click', () => {
      const dropdown = document.getElementById('navDropdown');
      dropdown.classList.toggle('hidden');
    });

    document.addEventListener('click', (event) => {
      const dropdown = document.getElementById('navDropdown');
      const button = document.getElementById('navButton');
      if (!button.contains(event.target) && !dropdown.contains(event.target)) {
        dropdown.classList.add('hidden');
      }
    });

    document.querySelectorAll('#navDropdown a').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const view = link.dataset.view;
        history.pushState({ view }, '', `#${view}`);
        loadView(view);
        document.getElementById('navDropdown').classList.add('hidden');
      });
    });

    window.addEventListener('popstate', (e) => {
      const view = e.state ? e.state.view : 'introduction';
      loadView(view);
    });

    const initialView = window.location.hash.replace('#', '') || 'introduction';
    history.replaceState({ view: initialView }, '', `#${initialView}`);
    loadView(initialView);
  </script>
</body>
</html>
